
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>✐ Filtrage numérique &#8212; Traitement du signal 2</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jbvinc.css" />
    <link rel="stylesheet" type="text/css" href="../_static/.ipynb_checkpoints/jbvinc-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Bruit dans les signaux" href="../bruit.html" />
    <link rel="prev" title="TP" href="../filtres-p.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="fr">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Traitement du signal 2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Révisions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../rev-t.html">
   ✎ Exercices théoriques
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../rev-p.html">
   ✎ Exercices sur machine
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="tp11.html">
     ✐ Représentation d’un signal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tp12.html">
     ✐ Produit de convolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tp13.html">
     ✐ Transformée de Fourier discrète
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tp14.html">
     ✐ Analyse spectrale
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Filtrage
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../filtres-intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtres-ideaux.html">
   Filtres idéaux
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtres-realisables.html">
   Filtres réalisables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../laplace.html">
   Transformée de Laplace
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../z.html">
   Transformée en Z
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../filtres-numeriques.html">
   Filtres numériques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../filtres-rif.html">
     Filtres RIF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../filtres-rii.html">
     Filtres RII
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtres-analogiques.html">
   Filtres analogiques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../filtres-t.html">
   ✎ Exercices théoriques
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../filtres-p.html">
   ✎ Exercices sur machine
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     ✐ Filtrage numérique
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Traitement statistique du signal
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../bruit.html">
   Bruit dans les signaux
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../traitement-bruit.html">
   Traitement des signaux bruités
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ssp-t.html">
   ✎ Exercices théoriques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ssp-p.html">
   ✎ Exercices sur machine
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Annexes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://moodle.unistra.fr/course/view.php?id=5497">
   Moodle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python.html">
   Installer et utiliser Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../refs.html">
   Références
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../licence.html">
   Licence
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/tp/tp2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#affichage-de-lecg-mesure">
   Affichage de l’ECG mesuré
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definition-du-gabarit">
   Définition du gabarit
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#realisation-d-un-filtre-rif-avec-la-methode-des-fenetres">
   Réalisation d’un filtre RIF avec la méthode des fenêtres
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#realisation-d-un-filtre-rii-avec-la-transformation-bilineaire">
   Réalisation d’un filtre RII avec la transformation bilinéaire
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#realisation-du-filtre-rif-avec-la-methode-de-parks-mcclellan">
   Réalisation du filtre RIF avec la méthode de Parks-McClellan
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#realisation-d-un-filtre-ideal">
   Réalisation d’un filtre idéal
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#application">
   Application
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#effet-de-la-quantification-des-coefficients">
   Effet de la quantification des coefficients
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>✐ Filtrage numérique</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#affichage-de-lecg-mesure">
   Affichage de l’ECG mesuré
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definition-du-gabarit">
   Définition du gabarit
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#realisation-d-un-filtre-rif-avec-la-methode-des-fenetres">
   Réalisation d’un filtre RIF avec la méthode des fenêtres
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#realisation-d-un-filtre-rii-avec-la-transformation-bilineaire">
   Réalisation d’un filtre RII avec la transformation bilinéaire
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#realisation-du-filtre-rif-avec-la-methode-de-parks-mcclellan">
   Réalisation du filtre RIF avec la méthode de Parks-McClellan
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#realisation-d-un-filtre-ideal">
   Réalisation d’un filtre idéal
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#application">
   Application
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#effet-de-la-quantification-des-coefficients">
   Effet de la quantification des coefficients
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="filtrage-numerique">
<h1>✐ Filtrage numérique<a class="headerlink" href="#filtrage-numerique" title="Lien permanent vers ce titre">#</a></h1>
<p>Les fonctions de filtrage sont dans <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html"><code class="docutils literal notranslate"><span class="pre">scipy.signal</span></code></a>.</p>
<section id="affichage-de-lecg-mesure">
<h2>Affichage de l’ECG mesuré<a class="headerlink" href="#affichage-de-lecg-mesure" title="Lien permanent vers ce titre">#</a></h2>
<p>Connaissant le nombre de points dans le signal (<code class="docutils literal notranslate"><span class="pre">numpy.shape</span></code>) et la fréquence d’échantillonnage, il est facile de générer le vecteur des échantillons.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/tp2_7_0.png" src="../_images/tp2_7_0.png" />
</div>
</div>
<p>Attention : avant de sous-échantillonner, il convient d’appliquer un filtre anti-repliement !
On peut utiliser la fonction <code class="docutils literal notranslate"><span class="pre">scipy.signal.decimate</span></code>.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/tp2_11_0.png" src="../_images/tp2_11_0.png" />
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/tp2_12_0.png" src="../_images/tp2_12_0.png" />
</div>
</div>
<p>L’observation du spectre nous permet d’affirmer que le signal ECG est plutôt basse fréquence,
mais cela on le savait déjà en observant le signal temporel.
La phase n’est pas interprétable ; cela arrive souvent sur les signaux réels.</p>
<p>Finalement, le spectre ne nous permet pas, ici,
de déterminer les contenus fréquentiels de la variation basse fréquence d’une part, et des ondes d’autre part.</p>
</section>
<section id="definition-du-gabarit">
<h2>Définition du gabarit<a class="headerlink" href="#definition-du-gabarit" title="Lien permanent vers ce titre">#</a></h2>
<p>Or, on sait que les ondes apparaissent toutes les secondes environ (il y a dix ondes sur presque dix secondes) :
leur fréquence d’apparition est donc de l’ordre du hertz.
D’autre part, la variation basse fréquence peut être assimilée (très grossièrement) à un sinus de période sept secondes
(donc de fréquence 1/7 Hz).
Aussi, pour éliminer la composante basse fréquence, il faut réaliser un filtre passe-haut
dont la fréquence de coupure est comprise entre 1/7 Hz et 1 Hz.</p>
<p>Nous choisissons donc le gabarit représenté ci-dessous, avec une fréquence de la bande passante à 1 Hz,
et une fréquence de la bande atténuée de 0,5 Hz.
Seule l’application sur le signal nous permettra d’affiner ces deux valeurs :
c’est pourquoi il est important de réaliser un code qui utilise des variables pour ces deux fréquences, afin de les changer facilement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gabarit numérique</span>
<span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fe</span><span class="o">/</span><span class="mi">2</span>
<span class="n">fp</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">edB</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">AdB</span> <span class="o">=</span> <span class="mi">60</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/tp2_16_0.png" src="../_images/tp2_16_0.png" />
</div>
</div>
</section>
<section id="realisation-d-un-filtre-rif-avec-la-methode-des-fenetres">
<h2>Réalisation d’un filtre RIF avec la méthode des fenêtres<a class="headerlink" href="#realisation-d-un-filtre-rif-avec-la-methode-des-fenetres" title="Lien permanent vers ce titre">#</a></h2>
<p>D’après le <a class="reference internal" href="../filtres-rif.html#s-methode-des-fenetres"><span class="std std-ref">tableau vu en cours</span></a>,
pour respecter une atténuation de 60 dB, nous pouvons utiliser les fenêtres de Blackman ou Kaiser
(à la condition que <span class="math notranslate nohighlight">\(\beta\)</span> soit suffisamment grand).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">largeur_de_transition</span> <span class="o">=</span> <span class="p">(</span><span class="n">fp</span><span class="o">-</span><span class="n">fs</span><span class="p">)</span> <span class="o">/</span> <span class="n">fe</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ordre des fenêtres (déterminé à partir de la largeur de transition) :
Blackmann :            N = 1100
Kaiser (beta = 6,76) : N = 864
Kaiser (beta = 8,96) : N = 1142
</pre></div>
</div>
</div>
</div>
<p>En pratique, l’ordre donné par la méthode des fenêtres est souvent trop grand.
Je choisis donc un ordre plus faible.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ordre du filtre RIF : 801
</pre></div>
</div>
<img alt="../_images/tp2_22_1.png" src="../_images/tp2_22_1.png" />
</div>
</div>
<p>Le filtre RIF synthétisé respecte bien le gabarit et ne génère aucune oscillation dans la bande passante.
La phase est linéaire, et donc le retard de groupe est constant.
Les deux pics visibles sur le retard de groupe sont probablement dus à des erreurs numériques.
Enfin, le filtre étant d’ordre très élevé, il existe énormément de zéros, qui sont visible sur le diagramme pôles-zéros.
Le filtre RIF est toujours stable, aucun pôle n’existe.</p>
</section>
<section id="realisation-d-un-filtre-rii-avec-la-transformation-bilineaire">
<h2>Réalisation d’un filtre RII avec la transformation bilinéaire<a class="headerlink" href="#realisation-d-un-filtre-rii-avec-la-transformation-bilineaire" title="Lien permanent vers ce titre">#</a></h2>
<p>Le gabarit analogique est le même que le gabarit numérique, à l’exception des fréquences qui sont calculée à partir de l’expression</p>
<div class="math notranslate nohighlight">
\[
f_a = \frac{f_e}{\pi} \tan\left(\pi\frac{f_n}{f_e}\right).
\]</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/tp2_26_0.png" src="../_images/tp2_26_0.png" />
</div>
</div>
<p>L’expression de la transformation bilinéaire permettant d’obtenir H(z) à partir de H(s) est :</p>
<div class="math notranslate nohighlight">
\[
H_n(z) = H_a\left(2f_e \left(\frac{1-z^{-1}}{1+z^{-1}}\right)\right).
\]</div>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">iirdesign</span></code> effectue le schéma complet de la transformation bilinéaire :
détermination du gabarit analogique, synthèse du filtre analogique, et enfin transformation de la fonction de transfert analogique en fonction de transfert numérique.</p>
<p>La fonction utilise <code class="docutils literal notranslate"><span class="pre">ordfunc</span></code> et <code class="docutils literal notranslate"><span class="pre">iirfilter</span></code> puis la transformée bilinéaire <code class="docutils literal notranslate"><span class="pre">bilinear_zpk</span></code>.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ordre du filtre RII : 6
</pre></div>
</div>
<img alt="../_images/tp2_29_1.png" src="../_images/tp2_29_1.png" />
</div>
</div>
<p>Le filtre RII synthétisé respecte bien le gabarit, quelques oscillations sont visibles dans la bande passante.
La phase évolue doucement mais présentent plusieurs « sauts ».
Les premiers sauts de phase ont une valeur de <span class="math notranslate nohighlight">\(\pi\)</span> et correspondent à une inversion de signe dans la réponse fréquentielle et se traduisent par un rebond sur le module.
Le dernier saut de phase a une valeur de <span class="math notranslate nohighlight">\(2\pi\)</span> et ne traduit aucun phénomène : ce saut existe seulement parce que la phase est ici représentée entre <span class="math notranslate nohighlight">\(-\pi\)</span> et <span class="math notranslate nohighlight">\(\pi\)</span>.
Comme la phase n’est pas linéaire, le retard de groupe n’est pas constant.
Enfin, le diagramme pôles-zéros fait apparaître des pôles qui sont tous dans le cercle unité : le filtre est donc stable.</p>
</section>
<section id="realisation-du-filtre-rif-avec-la-methode-de-parks-mcclellan">
<h2>Réalisation du filtre RIF avec la méthode de Parks-McClellan<a class="headerlink" href="#realisation-du-filtre-rif-avec-la-methode-de-parks-mcclellan" title="Lien permanent vers ce titre">#</a></h2>
<p>En général, la méthode de Parks-McClellan fourni des filtres RIF d’ordre moins élevés que ceux produits avec la méthode des fenêtres.
Mais dans notre cas, cette méthode ne donne pas de résultat satisfaisant (le gabarit n’est pas du tout respecté) car la bande de transition est très faible et très à gauche dans les fréquences.
Dans notre cas, cette méthode n’est donc pas utilisable.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/tp2_32_0.png" src="../_images/tp2_32_0.png" />
</div>
</div>
</section>
<section id="realisation-d-un-filtre-ideal">
<h2>Réalisation d’un filtre idéal<a class="headerlink" href="#realisation-d-un-filtre-ideal" title="Lien permanent vers ce titre">#</a></h2>
<p>Comme le signal ECG est enregistré, on peut y appliquer un filtre idéal en travaillant dans le domaine de Fourier.
Pour cela, on multiplie le spectre du signal par une réponse fréquentielle nulle pour les fréquences inférieures à la fréquence de coupure, et égale à 1 au delà.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_18609/1829404821.py:18: RuntimeWarning: divide by zero encountered in log10
  xmod.plot(f, 20*np.log10(abs(H)), clr)
</pre></div>
</div>
<img alt="../_images/tp2_34_1.png" src="../_images/tp2_34_1.png" />
</div>
</div>
<p>Le module du filtre idéal correspond bien à une porte.
Dans la représentation ci-dessous, la porte n’est visible que pour des fréquences supérieures à la fréquence de coupure car le module est tracé en échelle logarithmique, donc les amplitudes nulles de la réponse fréquentielle sont renvoyées en <span class="math notranslate nohighlight">\(-\infty\)</span>.
La phase est linéaire et même constante ; on ne représente pas le retard de groupe qui serait nul.
Enfin, le filtre n’ayant pas d’expression sous forme de fonction de transfert, on ne peut pas définir des pôles et des zéros et on ne peut donc pas représenter son ddiagramme pôles-zéros.</p>
</section>
<section id="application">
<h2>Application<a class="headerlink" href="#application" title="Lien permanent vers ce titre">#</a></h2>
<p>Nous représentons ci-dessous le signal temporel et son spectre du signal ECG original et des sorties des filtres (RIF, RII et idéal).</p>
<p>On observe que le filtre RIF donne un signal filtré plus « propre » (d’un point de vue médical) que le filtre RII.
Le filtre idéal est quant à lui encore meilleur.
Cela s’explique par le fait qu’il ne génère aucune oscillation, ni en bande atténuée ni en bande passante,
et que par ailleurs le signal basse fréquence de l’ECG est spectralement très différent du signal d’intérêt : on peut donc les séparer proprement par filtrage des fréquences.</p>
<p>Enfin, on peut également observer le retard de groupe important sur le filtre RIF.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/tp2_37_0.png" src="../_images/tp2_37_0.png" />
<img alt="../_images/tp2_37_1.png" src="../_images/tp2_37_1.png" />
<img alt="../_images/tp2_37_2.png" src="../_images/tp2_37_2.png" />
<img alt="../_images/tp2_37_3.png" src="../_images/tp2_37_3.png" />
</div>
</div>
</section>
<section id="effet-de-la-quantification-des-coefficients">
<h2>Effet de la quantification des coefficients<a class="headerlink" href="#effet-de-la-quantification-des-coefficients" title="Lien permanent vers ce titre">#</a></h2>
<p>En se concentrant sur les deux filtres à réaliser dans ce TP (le filtre RIF et le filtre RII), on constate que la précision des coefficients est importantes.
Dans les figures ci-dessous, on a représenté le gain de la réponse fréquentielle des deux filtres en n’utilisant que certains chiffres décimaux des coefficients : une troncature est donc effectuée.
On constate que le filtre RIF est plus stable à cette troncature car il respecte le gabarit même si peu de chiffres sont consercés.
Cela indique donc que la mémoire utilisée par chaque coefficient peut être moindre avec un filtre RIF qu’avec un filtre RII.
Mais ce gain possible en mémoire est contrebalancé par le fait que le filtre RIF nécessite beaucoup plus de coefficients que le filtre RII.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/vincent/anaconda3/lib/python3.9/site-packages/scipy/signal/filter_design.py:475: RuntimeWarning: divide by zero encountered in true_divide
  h = (npp_polyval(zm1, b, tensor=False) /
/home/vincent/anaconda3/lib/python3.9/site-packages/scipy/signal/filter_design.py:475: RuntimeWarning: invalid value encountered in true_divide
  h = (npp_polyval(zm1, b, tensor=False) /
</pre></div>
</div>
<img alt="../_images/tp2_39_1.png" src="../_images/tp2_39_1.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tp"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../filtres-p.html" title="précédent page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">précédent</p>
            <p class="prev-next-title">TP</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../bruit.html" title="suivant page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title">Bruit dans les signaux</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Vincent Mazet (Université de Strasbourg, France)<br/>
  
      &copy; Copyright 2022-2023.<br/>
    <div class="extra_footer">
      Traitement du signal 2 &mdash; Vincent Mazet (Université de Strasbourg), 2020-2023 &mdash; <a href='licence.html'>CC BY-NC 4.0</a>.
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>